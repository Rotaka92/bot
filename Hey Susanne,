Hey Susanne, 

Zunächst fiel mir direkt auf, dass es 116000 Rows sind, wobei es ja eigentlich nur 73000 (365*200) sein sollten.
Beim Durchblättern habe ich bemerkt, dass viele Einträge doppelt waren.
Nachdem ich nur DISTINCT-Einträge selected habe, kam ich auf 72800 Einträge. 

Demnach fehlt ein Tag, und zwar der 17.10.2018.

ISRCs, die nicht in den Top50 waren, kannst du der Query in der WITH-Funktion unten entnehmen ('isrc_list'). 
Daraufhin habe ich die 'streams_premium' für diese ISRCs, die niemals in den Top50 waren, aufsummiert und die 30 meistgehörtesten Streams herausgezogen.
Ich habe dann versucht, es innerhalb Excels wie Johannas Query aussehen zu lassen, jedoch wusste ich jetzt gegen Ende nicht, woher sie die letzten Variablen playlist_name, playlist_id, track_position, playlist_date, playlist_rank, usw. zieht.
Habe ja in meinen Tables keinerlei Angaben zu Playlisten und auch auf der Suche nach solchen Informationen bin ich nicht fündig geworden. 
Vielleicht verstehe ich es aber auch an dieser Stelle falsch und die Query soll gar nicht 1:1 so aussehen. 

Am besten wir setzen uns morgen nochmal zusammen :) 


Liebe Grüße
Robin






#StandardSQL
WITH isrc_list AS
(SELECT DISTINCT ISRC AS isrc0 FROM `umg-de.usr_swo.charts_spotify_daily` 
WHERE ISRC NOT IN (SELECT DISTINCT ISRC FROM `umg-de.usr_swo.charts_spotify_daily` 
WHERE position BETWEEN 1 AND 50))


SELECT isrc, artist, title, SUM(streams_premium) as aggr_streams_premium_2018
FROM `umg-de.prj_gfk_streaming.gfk_stream_de_2018` a
RIGHT JOIN isrc_list b on a.isrc = b.isrc0
GROUP BY 1,2,3
ORDER BY aggr_streams_premium_2018 DESC
LIMIT 30